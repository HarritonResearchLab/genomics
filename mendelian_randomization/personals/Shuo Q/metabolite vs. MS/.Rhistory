library(TwoSampleMR)
# 1. 3-Hydroxybutyrate: met-d-bOHbutyrate , met-c-846 , met-a-311
exposure <- extract_instruments("met-d-bOHbutyrate")
View(exposure)
remove(exposure)
library(tidyverse)
library(TwoSampleMR)
library(data.table)
exposures <- c("met-d-bOHbutyrate", "met-c-846", "met-a-311", "met-a-420", "met-a-471", "met-a-421", "met-a-393", "met-a-427", "met-d-Acetoacetate", "met-c-838", "met-a-446", "met-a-386")
outcomes <- c("ieu-b-18", "finn-b-G6_MS", "ukb-b-17670")
expo_11 <- extract_instruments("met-d-bOHbutyrate")
out_11 <- extract_outcome_data(snps = expo_11$SNP, outcomes = "eu-b-18")
hm_data <- harmonise_data(expo_11, out_11)
View(expo_11)
View(expo_11)
expo_11 <- extract_instruments("met-d-bOHbutyrate", p1 = 0.05, p2 = 0.05)
View(expo_11)
out_11 <- extract_outcome_data(snps = expo_11$SNP, outcomes = "eu-b-18")
out_11 <- extract_outcome_data(snps = expo_11$SNP, outcomes = "ieu-b-18")
View(out_11)
hm_data <- harmonise_data(expo_11, out_11)
mr_data <- mr(hm_data)
intercept_data <- mr_pleiotropy_test(hm_data)
het_data <- mr_heterogeneity(hm_data)
plot <- mr_scatter_plot(mr_data, hm_data)
plot[[1]]
reformed_table <- data.frame(
GWAS_ID = exposures[1],
# IVW method  3
b_IVW_MRE = mr_data[3,7],
se_IVW_MRE = mr_data[3,8],
pval_IVW_MRE = mr_data[3,9],
# Egger method  1
b_Egger = mr_data[1,7],
se_Egger = mr_data[1,8],
pval_Egger = mr_data[1,9],
# intercept missing
Egger_intercept = intercept_data[1,5],
pval_intercept = intercept_data[1,7],
# Heterogenous missing
Het_IVW_pval = het_data[2,8],
Het_Egger_pval = het_data[1,8],
# Weighted median  2
b_W_Med = mr_data[2,7],
se_W_Med = mr_data[2,8],
pval_W_Med = mr_data[2,9],
# Weighted mode  5
b_W_Mod = mr_data[5,7],
se_W_Mod = mr_data[5,8],
pval_W_Mod = mr_data[5,9],
# then
nsnps	= mr_data[1,6]
)
View(reformed_table)
