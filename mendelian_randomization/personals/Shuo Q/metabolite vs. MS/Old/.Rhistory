expo_11 <- extract_instruments("met-d-bOHbutyrate")
out_11 <- extract_outcome_data(snps = expo_11$SNP, outcomes = "ieu-b-18")
# ------------------ metabolite vs. MS
library(tidyverse)
library(TwoSampleMR)
library(data.table)
# expo_11 <- extract_instruments("met-d-bOHbutyrate", p1 = 0.05, p2 = 0.05)
expo_11 <- extract_instruments("met-d-bOHbutyrate")
out_11 <- extract_outcome_data(snps = expo_11$SNP, outcomes = "ieu-b-18")
hm_data <- harmonise_data(expo_11, out_11)
mr_data <- mr(hm_data)
View(mr_data)
intercept_data <- mr_pleiotropy_test(hm_data)
het_data <- mr_heterogeneity(hm_data)
plot <- mr_scatter_plot(mr_data, hm_data)
plot(plot[[1]])
reformed_table <- data.frame(
GWAS_ID = exposures[1],
# IVW method  3
b_IVW_MRE = mr_data[3,7],
se_IVW_MRE = mr_data[3,8],
pval_IVW_MRE = mr_data[3,9],
# Egger method  1
b_Egger = mr_data[1,7],
se_Egger = mr_data[1,8],
pval_Egger = mr_data[1,9],
# intercept missing
Egger_intercept = intercept_data[1,5],
pval_intercept = intercept_data[1,7],
# Heterogenous missing
Het_IVW_pval = het_data[2,8],
Het_Egger_pval = het_data[1,8],
# Weighted median  2
b_W_Med = mr_data[2,7],
se_W_Med = mr_data[2,8],
pval_W_Med = mr_data[2,9],
# Weighted mode  5
b_W_Mod = mr_data[5,7],
se_W_Mod = mr_data[5,8],
pval_W_Mod = mr_data[5,9],
# then
nsnps	= mr_data[1,6]
)
reformed_table <- data.frame(
GWAS_ID = expo_11[1],
# IVW method  3
b_IVW_MRE = mr_data[3,7],
se_IVW_MRE = mr_data[3,8],
pval_IVW_MRE = mr_data[3,9],
# Egger method  1
b_Egger = mr_data[1,7],
se_Egger = mr_data[1,8],
pval_Egger = mr_data[1,9],
# intercept missing
Egger_intercept = intercept_data[1,5],
pval_intercept = intercept_data[1,7],
# Heterogenous missing
Het_IVW_pval = het_data[2,8],
Het_Egger_pval = het_data[1,8],
# Weighted median  2
b_W_Med = mr_data[2,7],
se_W_Med = mr_data[2,8],
pval_W_Med = mr_data[2,9],
# Weighted mode  5
b_W_Mod = mr_data[5,7],
se_W_Mod = mr_data[5,8],
pval_W_Mod = mr_data[5,9],
# then
nsnps	= mr_data[1,6]
)
View(reformed_table)
View(mr_data)
reformed_table <- data.frame(
GWAS_ID = expo_11[1],
# IVW method  3
b_IVW_MRE = mr_data[3,7],
se_IVW_MRE = mr_data[3,8],
pval_IVW_MRE = mr_data[3,9],
# Egger method  1
b_Egger = mr_data[1,7],
se_Egger = mr_data[1,8],
pval_Egger = mr_data[1,9],
# intercept missing
Egger_intercept = intercept_data[1,5],
pval_intercept = intercept_data[1,7],
# Heterogenous missing
Het_IVW_pval = het_data[2,8],
Het_Egger_pval = het_data[1,8],
# Weighted median  2
b_W_Med = mr_data[2,7],
se_W_Med = mr_data[2,8],
pval_W_Med = mr_data[2,9],
# Weighted mode  5
b_W_Mod = mr_data[5,7],
se_W_Mod = mr_data[5,8],
pval_W_Mod = mr_data[5,9],
# then
nsnps	= mr_data[1,6]
)
View(reformed_table)
reformed_table <- data.frame(
# IVW method  3
b_IVW_MRE = mr_data[3,7],
se_IVW_MRE = mr_data[3,8],
pval_IVW_MRE = mr_data[3,9],
# Egger method  1
b_Egger = mr_data[1,7],
se_Egger = mr_data[1,8],
pval_Egger = mr_data[1,9],
# intercept missing
Egger_intercept = intercept_data[1,5],
pval_intercept = intercept_data[1,7],
# Heterogenous missing
Het_IVW_pval = het_data[2,8],
Het_Egger_pval = het_data[1,8],
# Weighted median  2
b_W_Med = mr_data[2,7],
se_W_Med = mr_data[2,8],
pval_W_Med = mr_data[2,9],
# Weighted mode  5
b_W_Mod = mr_data[5,7],
se_W_Mod = mr_data[5,8],
pval_W_Mod = mr_data[5,9],
# then
nsnps	= mr_data[1,6]
)
View(reformed_table)
View(reformed_table)
expo_12 <- extract_instruments("met-c-846")
out_12 <- extract_outcome_data(snps = expo_12$SNP, outcomes = "ieu-b-18")
hm_data(expo_12, out_12)
intercept_data <- mr_pleiotropy_test(hm_data)
het_data <- mr_heterogeneity(hm_data)
plot <- mr_scatter_plot(mr_data, hm_data)
plot(plot[[1]])
reformed_table <- data.frame(
# IVW method  3
b_IVW_MRE = mr_data[3,7],
se_IVW_MRE = mr_data[3,8],
pval_IVW_MRE = mr_data[3,9],
# Egger method  1
b_Egger = mr_data[1,7],
se_Egger = mr_data[1,8],
pval_Egger = mr_data[1,9],
# intercept missing
Egger_intercept = intercept_data[1,5],
pval_intercept = intercept_data[1,7],
# Heterogenous missing
Het_IVW_pval = het_data[2,8],
Het_Egger_pval = het_data[1,8],
# Weighted median  2
b_W_Med = mr_data[2,7],
se_W_Med = mr_data[2,8],
pval_W_Med = mr_data[2,9],
# Weighted mode  5
b_W_Mod = mr_data[5,7],
se_W_Mod = mr_data[5,8],
pval_W_Mod = mr_data[5,9],
# then
nsnps	= mr_data[1,6]
)
hm_data  <- harmonise_data(expo_12, out_12)
intercept_data <- mr_pleiotropy_test(hm_data)
het_data <- mr_heterogeneity(hm_data)
plot <- mr_scatter_plot(mr_data, hm_data)
plot(plot[[1]])
reformed_table <- data.frame(
# IVW method  3
b_IVW_MRE = mr_data[3,7],
se_IVW_MRE = mr_data[3,8],
pval_IVW_MRE = mr_data[3,9],
# Egger method  1
b_Egger = mr_data[1,7],
se_Egger = mr_data[1,8],
pval_Egger = mr_data[1,9],
# intercept missing
Egger_intercept = intercept_data[1,5],
pval_intercept = intercept_data[1,7],
# Heterogenous missing
Het_IVW_pval = het_data[2,8],
Het_Egger_pval = het_data[1,8],
# Weighted median  2
b_W_Med = mr_data[2,7],
se_W_Med = mr_data[2,8],
pval_W_Med = mr_data[2,9],
# Weighted mode  5
b_W_Mod = mr_data[5,7],
se_W_Mod = mr_data[5,8],
pval_W_Mod = mr_data[5,9],
# then
nsnps	= mr_data[1,6]
)
View(mr_data)
intercept_data <- mr_pleiotropy_test(hm_data)
het_data <- mr_heterogeneity(hm_data)
expo_12 <- extract_instruments("met-c-846", p1 = 0.05, p2 = 0.05)
out_12 <- extract_outcome_data(snps = expo_12$SNP, outcomes = "ieu-b-18")
hm_data  <- harmonise_data(expo_12, out_12)
intercept_data <- mr_pleiotropy_test(hm_data)
het_data <- mr_heterogeneity(hm_data)
plot <- mr_scatter_plot(mr_data, hm_data)
plot(plot[[1]])
reformed_table <- data.frame(
# IVW method  3
b_IVW_MRE = mr_data[3,7],
se_IVW_MRE = mr_data[3,8],
pval_IVW_MRE = mr_data[3,9],
# Egger method  1
b_Egger = mr_data[1,7],
se_Egger = mr_data[1,8],
pval_Egger = mr_data[1,9],
# intercept missing
Egger_intercept = intercept_data[1,5],
pval_intercept = intercept_data[1,7],
# Heterogenous missing
Het_IVW_pval = het_data[2,8],
Het_Egger_pval = het_data[1,8],
# Weighted median  2
b_W_Med = mr_data[2,7],
se_W_Med = mr_data[2,8],
pval_W_Med = mr_data[2,9],
# Weighted mode  5
b_W_Mod = mr_data[5,7],
se_W_Mod = mr_data[5,8],
pval_W_Mod = mr_data[5,9],
# then
nsnps	= mr_data[1,6]
)
View(het_data)
View(mr_data)
View(intercept_data)
View(reformed_table)
plot <- mr_scatter_plot(mr_data, hm_data)
plot <- mr_scatter_plot(mr_data, hm_data)
View(plot)
plot[["met-c-846.ieu-b-18"]]
plot(plot)
plot(plot[1])
plot(plot[[1]])
plot <- mr_scatter_plot(mr_data, hm_data)
expo_11 <- extract_instruments("met-d-bOHbutyrate", p1 = 0.05, p2 = 0.05)
out_11 <- extract_outcome_data(snps = expo_11$SNP, outcomes = "ieu-b-18")
hm_data <- harmonise_data(expo_11, out_11)
mr_data <- mr(hm_data)
intercept_data <- mr_pleiotropy_test(hm_data)
het_data <- mr_heterogeneity(hm_data)
plot <- mr_scatter_plot(mr_data, hm_data)
plot(plot[[1]])
View(mr_data)
# ------------------ metabolite vs. MS
library(tidyverse)
library(TwoSampleMR)
library(data.table)
expo_11 <- extract_instruments("met-c-838")
out_11 <- extract_outcome_data(snps = expo_11$SNP, outcomes = "ieu-b-18")
hm_data <- harmonise_data(expo_11, out_11)
mr_data <- mr(hm_data, method_list = c("mr_egger_regression", "mr_weighted_median", "mr_ivw", "mr_weighted_mode"))
View(mr_data)
head(mr_data)
print('yes')
if(dim(mr_data) == 0){
print('yes')
}
if(dim(mr_data)[1] == 0){
print('yes')
}
mr_data <- mr(hm_data)
if(dim(mr_data)[1] == 0){
print('yes')
}
if(dim(mr_data)[1] == 0){
print('nothing here')
}else if (dim(mr_data)[1] != 0){
print("data exists")
}
if(dim(mr_data)[1] == 0){
print('nothing here')
}else if (dim(mr_data)[1] == 1){
print("data exists one row")
}else if (dim(mr_data)[1] != 0){
print("data exists")
}
expo_12 <- extract_instruments("met-c-846")
out_12 <- extract_outcome_data(snps = expo_12$SNP, outcomes = "ukb-b-17670")
hm_data  <- harmonise_data(expo_12, out_12)
expo_13 <- extract_instruments("met-a-311")
out_13 <- extract_outcome_data(snps = expo_13$SNP, "ieu-b-18")
hm_data <- harmonise_data(expo_13, out_13)
