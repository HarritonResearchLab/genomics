library(tidyverse)
library(data.table)
library(TwoSampleMR)
bmi_ins <- extract_instruments("ieu-b-40")
vita_ins <- extract_instruments('ebi-a-GCST005367')
View(vita_ins)
example_out <- extract_outcome_data('ieu-b-18')
Finnish_out <- extract_outcome_data('finn-b-G6_MS')
UK_out <- extract_outcome_data('ukb-b-17670')
library(tidyverse)
library(data.table)
library(TwoSampleMR)
example_out <- extract_outcome_data('ieu-b-18')
# --------- get the outcomes from outcome
example_out <- extract_outcome_data(outcomes = 'ieu-b-18')
View(bmi_ins)
View(vita_ins)
bmi_example_out <- extract_outcome_data(snps = bmi_ins$SNP, outcomes = 'ieu-b-18')
bmi_Finnish_out <- extract_outcome_data(snps = bmi_ins$SNP, outcomes = 'finn-b-G6_MS')
bmi_UK_out <- extract_outcome_data(snps = bmi_ins$SNP, outcomes = 'ukb-b-17670')
#for Vitamin D
vit_exa_out <- extract_outcome_data(snps = vit_ins$SNP, outcomes = "ieu-b-18")
vit_Fin_out <- extract_outcome_data(snps = vit_ins$SNP, outcomes = 'finn-b-G6_MS')
vit_UK_out <- extract_outcome_data(snps = vit_ins$SNP, outcomes = 'ukb-b-17670')
vit_ins <- extract_instruments('ebi-a-GCST005367')
remove(vita_ins)
vit_exa_out <- extract_outcome_data(snps = vit_ins$SNP, outcomes = "ieu-b-18")
vit_Fin_out <- extract_outcome_data(snps = vit_ins$SNP, outcomes = 'finn-b-G6_MS')
vit_UK_out <- extract_outcome_data(snps = vit_ins$SNP, outcomes = 'ukb-b-17670')
bmi_exa_hm <- harmonise_data(bmi_ins, example_out)
bmi_Fin_hm <- harmonise_data(bmi_ins, Finnish_out)
bmi_UK_hm <- harmonise_data(bmi_ins, UK_out)
bmi_exa_hm <- harmonise_data(bmi_ins, bmi_example_out)
bmi_Fin_hm <- harmonise_data(bmi_ins, bmi_Finnish_out)
bmi_UK_hm <- harmonise_data(bmi_ins, bmi_UK_out)
# --------- harmonise data for Vitamin D vs outcomes
vit_exa_hm <- harmonise_data(vit_ins, vit_exa_out)
vit_Fin_hm <- harmonise_data(vit_ins, vit_Fin_out)
vit_UK_hm <- harmonise_data(vit_ins, vit_UK_out)
bmi_exa_mr <- mr(bmi_exa_hm)
bmi_Fin_mr <- mr(bmi_Fin_hm)
bmi_UK_mr <- mr(bmi_UK_hm)
vit_exa_mr <- mr(vit_exa_hm)
vit_Fin_mr <- mr(vit_Fin_hm)
vit_UK_mr <- mr(vit_UK_hm)
# plot
bmi_exa_plot <- mr_scatter_plot(bmi_exa_mr, bmi_exa_hm)
bmi_exa_plot[[1]]
vit_exa_plot <- mr_scatter_plot(vit_exa_mr, vit_exa_hm)
vit_Fin_plot <- mr_scatter_plot(vit_Fin_mr, vit_Fin_hm)
vit_UK_plot <- mr_scatter_plot(vit_UK_mr, vit_UK_hm)
bmi_exa_plot <- mr_scatter_plot(bmi_exa_mr, bmi_exa_hm)
bmi_Fin_plot <- mr_scatter_plot(bmi_Fin_mr, bmi_Fin_hm)
bmi_UK_plot <- mr_scatter_plot(bmi_UK_mr, bmi_UK_hm)
bmi_Fin_plot[[1]]
bmi_UK_plot[[1]]
vit_Fin_plot[[1]]
# get plot printed
vit_exa_plot[[1]]
vit_UK_plot[[1]]
# get plot printed
bmi_exa_plot[[1]]
# get plot printed
vit_exa_plot[[1]]
# get plot printed
bmi_exa_plot[[1]]
bmi_Fin_plot[[1]]
bmi_UK_plot[[1]]
# get plot printed
vit_exa_plot[[1]]
vit_Fin_plot[[1]]
vit_UK_plot[[1]]
vit_UK_plot[[1]]
View(bmi_exa_mr)
View(vit_Fin_hm)
View(vit_Fin_hm)
View(vit_UK_mr)
View(vit_UK_out)
# save the data into the local
all_mr = c("bmi_exa_mr","bmi_Fin_mr","bmi_UK_mr","vit_exa_mr","vit_Fin_mr","vit_UK_mr")
all_mr = c("bmi_exa_mr","bmi_Fin_mr","bmi_UK_mr","vit_exa_mr","vit_Fin_mr","vit_UK_mr")
for (name in all_mr) {
write.table(name, file = name + ".csv")
}
write.table(name, file = "name.csv")
library(data.table)
install.packages("WriteXLS")
library(WriteXLS)
for (name in all_mr) {
WriteXLS(name, ExcelFileName = "data.xlsx" )
}
WriteXLS(all_mr, ExcelFileName = "data.xlsx" )
WriteXLS(bmi_exa_mr, ExcelFileName = "data.xlsx" )
WriteXLS(bmi_exa_mr, ExcelFileName = "data.xlsx",
SheetNames = "bmi_exa",
AdjWidth = T,
BoldHeaderRow = T)
Write.XLS(bmi_exa_mr, ExcelFileName = "data.xlsx",
SheetNames = "bmi_exa",
AdjWidth = T,
BoldHeaderRow = T)
WriteXLS(bmi_exa_mr, ExcelFileName = "data.xlsx",
SheetNames = "bmi_exa",
AdjWidth = T,
BoldHeaderRow = T)
write.table(all_mr, file = "data.csv" )
write.table(all_mr, file = "data.csv" )
write.table(bmi_exa_mr, file = "data.csv" )
View(vit_UK_mr)
View(vit_UK_plot)
View(vit_UK_out)
WriteXLS(bmi_exa_mr, ExcelFileName = "data.xlsx",
SheetNames = "my data",
AdjWidth = T,
BoldHeaderRow = T)
library(WriteXLS)
WriteXLS(bmi_exa_mr, ExcelFileName = "data.xlsx",
SheetNames = "my data",
AdjWidth = T,
BoldHeaderRow = T)
remove.packages(WriteXLS)
remove.packages("WriteXLS")
write.csv(bmi_exa_mr, file = "bmi_exa")
# save tables
all_mr = c("bmi_exa_mr","bmi_Fin_mr","bmi_UK_mr","vit_exa_mr","vit_Fin_mr","vit_UK_mr")
for (i in all_mr){
write.csv(all_mr[i], file = gettext(i + '.csv'), row.names = F)
}
for (i in 1:length(all_mr)){
filename = gettext(i + ".csv")
write.csv(all_mr[i], file = filename, row.names = F)
}
for (i in 1:length(all_mr)){
filename = gettext(i)
write.csv(all_mr[i], file = filename, row.names = F)
}
for (i in 1:length(all_mr)){
filename = gettext(all_mr[i])
write.csv(all_mr[i], file = filename, row.names = F)
}
# save tables
all_mr = c(bmi_exa_mr,bmi_Fin_mr,bmi_UK_mr,vit_exa_mr,vit_Fin_mr,vit_UK_mr)
for (i in 1:length(all_mr)){
filename = gettext(all_mr[i])
write.csv(all_mr[i], file = filename, row.names = F)
}
print(filename)
print(all_mr)
for (i in 1:length(all_mr)){
filenames = gettext(all_mr[i])
write.csv(all_mr[i], file = filenames, row.names = F)
}
remove(filename)
write.csv(bmi_exa_mr, file = "bmi_exa.csv", row.names = F)
write.csv(bmi_Fin_mr, file = "bmi_exa.csv", row.names = F)
write.csv(bmi_UK_mr, file = "bmi_exa.csv", row.names = F)
write.csv(vit_exa_mr, file = "bmi_exa.csv", row.names = F)
write.csv(vit_Fin_mr, file = "bmi_exa.csv", row.names = F)
write.csv(vit_UK_mr, file = "bmi_exa.csv", row.names = F)
# save tables
remove(all_mr)
# save tables
remove(filenames,i)
write.csv(bmi_exa_mr, file = "bmi_exa.csv", row.names = F)
write.csv(bmi_Fin_mr, file = "bmi_Fin.csv", row.names = F)
write.csv(bmi_UK_mr, file = "bmi_UK.csv", row.names = F)
write.csv(vit_exa_mr, file = "vit_exa_mr", row.names = F)
write.csv(vit_Fin_mr, file = "vit_Fin_mr", row.names = F)
write.csv(vit_UK_mr, file = "vit_UK_mr", row.names = F)
write.csv(vit_exa_mr, file = "vit_exa.csv", row.names = F)
write.csv(vit_Fin_mr, file = "vit_Fin.csv", row.names = F)
write.csv(vit_UK_mr, file = "vit_UK.csv", row.names = F)
library(tidyverse)
library(data.table)
library(TwoSampleMR)
# Het Test
bmi_exa_het <- mr_heterogeneity(bmi_exa_hm)
head(bmi_exa_het)
View(bmi_exa_het)
bmi_exa_het <- mr_heterogeneity(bmi_exa_hm)
bmi_Fin_het <- mr_heterogeneity(bmi_Fin_hm)
bmi_UK_het <- mr_heterogeneity(bmi_UK_hm)
vit_exa_het <- mr_heterogeneity(vit_exa_hm)
vit_Fin_het <- mr_heterogeneity(vit_Fin_hm)
vit_UK_het <- mr_heterogeneity(vit_UK_hm)
View(bmi_Fin_het)
View(bmi_exa_hm)
View(bmi_exa_mr)
View(bmi_Fin_mr)
View(bmi_UK_mr)
# reform data into tables
table_name <- c(bmi_exa_mr)
for (table in table_name){
reformed_table <- data.frame(
# IVW method  3
b_IVW_MRE = table[3,7],
se_IVW_MRE = table[3,8],
pval_IVW_MRE = table[3,9],
# Egger method  1
b_Egger = table[1,7],
se_Egger = table[1,8],
pval_Egger = table[1,9],
# Weighted median  2
b_W_Med = table[2,7],
se_W_Med = table[2,8],
pval_W_Med = table[2,9],
# Weighted mode  5
b_W_Mod = table[5,7],
se_W_Mod = table[5,8],
pval_W_Mod = table[5,9],
# then
nsnps	= table[1,10]
# Heterogenous missing
# intercept missing
)
names(reformed_table) = paste0("reformed",name)
}
bmi_exa_mr[3,7]
View(bmi_exa_mr)
View(bmi_exa_mr)
# reform data into tables
table_name <- c("bmi_exa_mr")
reformed_table <- data.frame(
# IVW method  3
b_IVW_MRE = table[3,7],
se_IVW_MRE = table[3,8],
pval_IVW_MRE = table[3,9],
# Egger method  1
b_Egger = table[1,7],
se_Egger = table[1,8],
pval_Egger = table[1,9],
# Weighted median  2
b_W_Med = table[2,7],
se_W_Med = table[2,8],
pval_W_Med = table[2,9],
# Weighted mode  5
b_W_Mod = table[5,7],
se_W_Mod = table[5,8],
pval_W_Mod = table[5,9],
# then
nsnps	= table[1,10]
# Heterogenous missing
# intercept missing
)
bmi_exa_mr$b[3]
reformed_table <- data.frame(
# IVW method  3
b_IVW_MRE = table$b[3],
se_IVW_MRE = table$se[3],
pval_IVW_MRE = table$pval[3],
# Egger method  1
b_Egger = table$b[1],
se_Egger = table$se[1],
pval_Egger = table$pval[1],
# Weighted median  2
b_W_Med = table$b[2],
se_W_Med = table$se[2],
pval_W_Med = table$pval[2],
# Weighted mode  5
b_W_Mod = table$b[5],
se_W_Mod = table$se[5],
pval_W_Mod = table$pval[5],
# then
nsnps	= table$nsnp[1]
# Heterogenous missing
# intercept missing
)
bmi_exa_mr$b[3]
reformed_table <- data.frame(
# IVW method  3
b_IVW_MRE = bmi_exa_mr$b[3],
se_IVW_MRE = bmi_exa_mr$se[3],
pval_IVW_MRE = bmi_exa_mr$pval[3],
# Egger method  1
b_Egger = bmi_exa_mr$b[1],
se_Egger = bmi_exa_mr$se[1],
pval_Egger = bmi_exa_mr$pval[1],
# Weighted median  2
b_W_Med = bmi_exa_mr$b[2],
se_W_Med = bmi_exa_mr$se[2],
pval_W_Med = bmi_exa_mr$pval[2],
# Weighted mode  5
b_W_Mod = bmi_exa_mr$b[5],
se_W_Mod = bmi_exa_mr$se[5],
pval_W_Mod = bmi_exa_mr$pval[5],
# then
nsnps	= bmi_exa_mr$nsnp[1]
)
View(reformed_table)
bmi_exa_reformed <- data.frame(
# IVW method  3
b_IVW_MRE = bmi_exa_mr$b[3],
se_IVW_MRE = bmi_exa_mr$se[3],
pval_IVW_MRE = bmi_exa_mr$pval[3],
# Egger method  1
b_Egger = bmi_exa_mr$b[1],
se_Egger = bmi_exa_mr$se[1],
pval_Egger = bmi_exa_mr$pval[1],
# Weighted median  2
b_W_Med = bmi_exa_mr$b[2],
se_W_Med = bmi_exa_mr$se[2],
pval_W_Med = bmi_exa_mr$pval[2],
# Weighted mode  5
b_W_Mod = bmi_exa_mr$b[5],
se_W_Mod = bmi_exa_mr$se[5],
pval_W_Mod = bmi_exa_mr$pval[5],
# then
nsnps	= bmi_exa_mr$nsnp[1]
)
remove(reformed_table)
