jupyter
jupyter notebook
jupyter notebook
jupyter
IRkernel::installspec(user = FALSE)
help("if")
help("break")
# outcomes as exa ( reform could be included in this loop so don't need to read the raw data again)
for(i in 1:length(exposures)){
if(i == 3){
break
}
help("break")
expo_data <- extract_instruments(exposures[i], p1 = 0.05, p2 = 0.05)
out_data <- extract_outcome_data(snps = expo_data$SNP, outcomes = outcomes[1])
print(exposures[i])
print(outcomes[1])
print("===================== extract down =====================")
# analysis
hm_data <- harmonise_data(expo_data, out_data)
mr_data <- mr(hm_data)
intercept_data <- mr_pleiotropy_test(hm_data)
het_data <- mr_heterogeneity(hm_data)
print("===================== analysis down =====================")
# plots
plot <- mr_scatter_plot(mr_data, hm_data)
plot[[1]]
print("===================== plot down =====================")
# reform table
reformed_table <- data.frame(
GWAS_ID = exposures[i],
# IVW method  3
b_IVW_MRE = mr_data[3,7],
se_IVW_MRE = mr_data[3,8],
pval_IVW_MRE = mr_data[3,9],
# Egger method  1
b_Egger = mr_data[1,7],
se_Egger = mr_data[1,8],
pval_Egger = mr_data[1,9],
# intercept missing
Egger_intercept = intercept_data[1,5],
pval_intercept = intercept_data[1,7],
# Heterogenous missing
Het_IVW_pval = het_data[2,8],
Het_Egger_pval = het_data[1,8],
# Weighted median  2
b_W_Med = mr_data[2,7],
se_W_Med = mr_data[2,8],
pval_W_Med = mr_data[2,9],
# Weighted mode  5
b_W_Mod = mr_data[5,7],
se_W_Mod = mr_data[5,8],
pval_W_Mod = mr_data[5,9],
# then
nsnps	= mr_data[1,6]
)
# need to assign names and save things
print("===================== reform down =====================")
#save the file with .csv
setwd("D:/Software/Github/genomics/mendelian_randomization/personals/Shuo Q/metabolite vs. MS/results")
filename <- paste(exposures[i],".csv", sep = "")
write.csv(reformed_table, file = filename, row.names = F)
print("===================== file saved =====================")
}
library(tidyverse)
library(TwoSampleMR)
library(data.table)
exposures <- c("met-d-bOHbutyrate", "met-c-846", "met-a-311")
outcomes <- c("ieu-b-18", "finn-b-G6_MS", "ukb-b-17670")
# outcomes as exa ( reform could be included in this loop so don't need to read the raw data again)
for(i in 1:length(exposures)){
if(i == 3){
break
}
help("break")
expo_data <- extract_instruments(exposures[i], p1 = 0.05, p2 = 0.05)
out_data <- extract_outcome_data(snps = expo_data$SNP, outcomes = outcomes[1])
print(exposures[i])
print(outcomes[1])
print("===================== extract down =====================")
# analysis
hm_data <- harmonise_data(expo_data, out_data)
mr_data <- mr(hm_data)
intercept_data <- mr_pleiotropy_test(hm_data)
het_data <- mr_heterogeneity(hm_data)
print("===================== analysis down =====================")
# plots
plot <- mr_scatter_plot(mr_data, hm_data)
plot[[1]]
print("===================== plot down =====================")
# reform table
reformed_table <- data.frame(
GWAS_ID = exposures[i],
# IVW method  3
b_IVW_MRE = mr_data[3,7],
se_IVW_MRE = mr_data[3,8],
pval_IVW_MRE = mr_data[3,9],
# Egger method  1
b_Egger = mr_data[1,7],
se_Egger = mr_data[1,8],
pval_Egger = mr_data[1,9],
# intercept missing
Egger_intercept = intercept_data[1,5],
pval_intercept = intercept_data[1,7],
# Heterogenous missing
Het_IVW_pval = het_data[2,8],
Het_Egger_pval = het_data[1,8],
# Weighted median  2
b_W_Med = mr_data[2,7],
se_W_Med = mr_data[2,8],
pval_W_Med = mr_data[2,9],
# Weighted mode  5
b_W_Mod = mr_data[5,7],
se_W_Mod = mr_data[5,8],
pval_W_Mod = mr_data[5,9],
# then
nsnps	= mr_data[1,6]
)
# need to assign names and save things
print("===================== reform down =====================")
#save the file with .csv
setwd("D:/Software/Github/genomics/mendelian_randomization/personals/Shuo Q/metabolite vs. MS/results")
filename <- paste(exposures[i],".csv", sep = "")
write.csv(reformed_table, file = filename, row.names = F)
print("===================== file saved =====================")
}
View(plot)
plot
plot(plot[[1]])
plot(plot[[2]])
View(mr_data)
