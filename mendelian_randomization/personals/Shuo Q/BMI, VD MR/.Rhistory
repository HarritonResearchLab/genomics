library(tidyverse)
library(data.table)
library(TwoSampleMR)
bmi_ins <- extract_instruments("ieu-b-40")
vita_ins <- extract_instruments('ebi-a-GCST005367')
View(vita_ins)
example_out <- extract_outcome_data('ieu-b-18')
Finnish_out <- extract_outcome_data('finn-b-G6_MS')
UK_out <- extract_outcome_data('ukb-b-17670')
library(tidyverse)
library(data.table)
library(TwoSampleMR)
example_out <- extract_outcome_data('ieu-b-18')
# --------- get the outcomes from outcome
example_out <- extract_outcome_data(outcomes = 'ieu-b-18')
View(bmi_ins)
View(vita_ins)
bmi_example_out <- extract_outcome_data(snps = bmi_ins$SNP, outcomes = 'ieu-b-18')
bmi_Finnish_out <- extract_outcome_data(snps = bmi_ins$SNP, outcomes = 'finn-b-G6_MS')
bmi_UK_out <- extract_outcome_data(snps = bmi_ins$SNP, outcomes = 'ukb-b-17670')
#for Vitamin D
vit_exa_out <- extract_outcome_data(snps = vit_ins$SNP, outcomes = "ieu-b-18")
vit_Fin_out <- extract_outcome_data(snps = vit_ins$SNP, outcomes = 'finn-b-G6_MS')
vit_UK_out <- extract_outcome_data(snps = vit_ins$SNP, outcomes = 'ukb-b-17670')
vit_ins <- extract_instruments('ebi-a-GCST005367')
remove(vita_ins)
vit_exa_out <- extract_outcome_data(snps = vit_ins$SNP, outcomes = "ieu-b-18")
vit_Fin_out <- extract_outcome_data(snps = vit_ins$SNP, outcomes = 'finn-b-G6_MS')
vit_UK_out <- extract_outcome_data(snps = vit_ins$SNP, outcomes = 'ukb-b-17670')
bmi_exa_hm <- harmonise_data(bmi_ins, example_out)
bmi_Fin_hm <- harmonise_data(bmi_ins, Finnish_out)
bmi_UK_hm <- harmonise_data(bmi_ins, UK_out)
bmi_exa_hm <- harmonise_data(bmi_ins, bmi_example_out)
bmi_Fin_hm <- harmonise_data(bmi_ins, bmi_Finnish_out)
bmi_UK_hm <- harmonise_data(bmi_ins, bmi_UK_out)
# --------- harmonise data for Vitamin D vs outcomes
vit_exa_hm <- harmonise_data(vit_ins, vit_exa_out)
vit_Fin_hm <- harmonise_data(vit_ins, vit_Fin_out)
vit_UK_hm <- harmonise_data(vit_ins, vit_UK_out)
bmi_exa_mr <- mr(bmi_exa_hm)
bmi_Fin_mr <- mr(bmi_Fin_hm)
bmi_UK_mr <- mr(bmi_UK_hm)
vit_exa_mr <- mr(vit_exa_hm)
vit_Fin_mr <- mr(vit_Fin_hm)
vit_UK_mr <- mr(vit_UK_hm)
# plot
bmi_exa_plot <- mr_scatter_plot(bmi_exa_mr, bmi_exa_hm)
bmi_exa_plot[[1]]
vit_exa_plot <- mr_scatter_plot(vit_exa_mr, vit_exa_hm)
vit_Fin_plot <- mr_scatter_plot(vit_Fin_mr, vit_Fin_hm)
vit_UK_plot <- mr_scatter_plot(vit_UK_mr, vit_UK_hm)
bmi_exa_plot <- mr_scatter_plot(bmi_exa_mr, bmi_exa_hm)
bmi_Fin_plot <- mr_scatter_plot(bmi_Fin_mr, bmi_Fin_hm)
bmi_UK_plot <- mr_scatter_plot(bmi_UK_mr, bmi_UK_hm)
bmi_Fin_plot[[1]]
bmi_UK_plot[[1]]
vit_Fin_plot[[1]]
# get plot printed
vit_exa_plot[[1]]
vit_UK_plot[[1]]
# get plot printed
bmi_exa_plot[[1]]
# get plot printed
vit_exa_plot[[1]]
# get plot printed
bmi_exa_plot[[1]]
bmi_Fin_plot[[1]]
bmi_UK_plot[[1]]
# get plot printed
vit_exa_plot[[1]]
vit_Fin_plot[[1]]
vit_UK_plot[[1]]
