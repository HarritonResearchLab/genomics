vit_Fin_hm <- harmonise_data(vit_ins, vit_Fin_out)
vit_UK_hm <- harmonise_data(vit_ins, vit_UK_out)
bmi_exa_mr <- mr(bmi_exa_hm)
bmi_Fin_mr <- mr(bmi_Fin_hm)
bmi_UK_mr <- mr(bmi_UK_hm)
vit_exa_mr <- mr(vit_exa_hm)
vit_Fin_mr <- mr(vit_Fin_hm)
vit_UK_mr <- mr(vit_UK_hm)
# plot
bmi_exa_plot <- mr_scatter_plot(bmi_exa_mr, bmi_exa_hm)
bmi_exa_plot[[1]]
vit_exa_plot <- mr_scatter_plot(vit_exa_mr, vit_exa_hm)
vit_Fin_plot <- mr_scatter_plot(vit_Fin_mr, vit_Fin_hm)
vit_UK_plot <- mr_scatter_plot(vit_UK_mr, vit_UK_hm)
bmi_exa_plot <- mr_scatter_plot(bmi_exa_mr, bmi_exa_hm)
bmi_Fin_plot <- mr_scatter_plot(bmi_Fin_mr, bmi_Fin_hm)
bmi_UK_plot <- mr_scatter_plot(bmi_UK_mr, bmi_UK_hm)
bmi_Fin_plot[[1]]
bmi_UK_plot[[1]]
vit_Fin_plot[[1]]
# get plot printed
vit_exa_plot[[1]]
vit_UK_plot[[1]]
# get plot printed
bmi_exa_plot[[1]]
# get plot printed
vit_exa_plot[[1]]
# get plot printed
bmi_exa_plot[[1]]
bmi_Fin_plot[[1]]
bmi_UK_plot[[1]]
# get plot printed
vit_exa_plot[[1]]
vit_Fin_plot[[1]]
vit_UK_plot[[1]]
vit_UK_plot[[1]]
View(bmi_exa_mr)
View(vit_Fin_hm)
View(vit_Fin_hm)
View(vit_UK_mr)
View(vit_UK_out)
# save the data into the local
all_mr = c("bmi_exa_mr","bmi_Fin_mr","bmi_UK_mr","vit_exa_mr","vit_Fin_mr","vit_UK_mr")
all_mr = c("bmi_exa_mr","bmi_Fin_mr","bmi_UK_mr","vit_exa_mr","vit_Fin_mr","vit_UK_mr")
for (name in all_mr) {
write.table(name, file = name + ".csv")
}
write.table(name, file = "name.csv")
library(data.table)
install.packages("WriteXLS")
library(WriteXLS)
for (name in all_mr) {
WriteXLS(name, ExcelFileName = "data.xlsx" )
}
WriteXLS(all_mr, ExcelFileName = "data.xlsx" )
WriteXLS(bmi_exa_mr, ExcelFileName = "data.xlsx" )
WriteXLS(bmi_exa_mr, ExcelFileName = "data.xlsx",
SheetNames = "bmi_exa",
AdjWidth = T,
BoldHeaderRow = T)
Write.XLS(bmi_exa_mr, ExcelFileName = "data.xlsx",
SheetNames = "bmi_exa",
AdjWidth = T,
BoldHeaderRow = T)
WriteXLS(bmi_exa_mr, ExcelFileName = "data.xlsx",
SheetNames = "bmi_exa",
AdjWidth = T,
BoldHeaderRow = T)
write.table(all_mr, file = "data.csv" )
write.table(all_mr, file = "data.csv" )
write.table(bmi_exa_mr, file = "data.csv" )
View(vit_UK_mr)
View(vit_UK_plot)
View(vit_UK_out)
WriteXLS(bmi_exa_mr, ExcelFileName = "data.xlsx",
SheetNames = "my data",
AdjWidth = T,
BoldHeaderRow = T)
library(WriteXLS)
WriteXLS(bmi_exa_mr, ExcelFileName = "data.xlsx",
SheetNames = "my data",
AdjWidth = T,
BoldHeaderRow = T)
remove.packages(WriteXLS)
remove.packages("WriteXLS")
write.csv(bmi_exa_mr, file = "bmi_exa")
# save tables
all_mr = c("bmi_exa_mr","bmi_Fin_mr","bmi_UK_mr","vit_exa_mr","vit_Fin_mr","vit_UK_mr")
for (i in all_mr){
write.csv(all_mr[i], file = gettext(i + '.csv'), row.names = F)
}
for (i in 1:length(all_mr)){
filename = gettext(i + ".csv")
write.csv(all_mr[i], file = filename, row.names = F)
}
for (i in 1:length(all_mr)){
filename = gettext(i)
write.csv(all_mr[i], file = filename, row.names = F)
}
for (i in 1:length(all_mr)){
filename = gettext(all_mr[i])
write.csv(all_mr[i], file = filename, row.names = F)
}
# save tables
all_mr = c(bmi_exa_mr,bmi_Fin_mr,bmi_UK_mr,vit_exa_mr,vit_Fin_mr,vit_UK_mr)
for (i in 1:length(all_mr)){
filename = gettext(all_mr[i])
write.csv(all_mr[i], file = filename, row.names = F)
}
print(filename)
print(all_mr)
for (i in 1:length(all_mr)){
filenames = gettext(all_mr[i])
write.csv(all_mr[i], file = filenames, row.names = F)
}
remove(filename)
write.csv(bmi_exa_mr, file = "bmi_exa.csv", row.names = F)
write.csv(bmi_Fin_mr, file = "bmi_exa.csv", row.names = F)
write.csv(bmi_UK_mr, file = "bmi_exa.csv", row.names = F)
write.csv(vit_exa_mr, file = "bmi_exa.csv", row.names = F)
write.csv(vit_Fin_mr, file = "bmi_exa.csv", row.names = F)
write.csv(vit_UK_mr, file = "bmi_exa.csv", row.names = F)
# save tables
remove(all_mr)
# save tables
remove(filenames,i)
write.csv(bmi_exa_mr, file = "bmi_exa.csv", row.names = F)
write.csv(bmi_Fin_mr, file = "bmi_Fin.csv", row.names = F)
write.csv(bmi_UK_mr, file = "bmi_UK.csv", row.names = F)
write.csv(vit_exa_mr, file = "vit_exa_mr", row.names = F)
write.csv(vit_Fin_mr, file = "vit_Fin_mr", row.names = F)
write.csv(vit_UK_mr, file = "vit_UK_mr", row.names = F)
write.csv(vit_exa_mr, file = "vit_exa.csv", row.names = F)
write.csv(vit_Fin_mr, file = "vit_Fin.csv", row.names = F)
write.csv(vit_UK_mr, file = "vit_UK.csv", row.names = F)
library(tidyverse)
library(data.table)
library(TwoSampleMR)
# Het Test
bmi_exa_het <- mr_heterogeneity(bmi_exa_hm)
head(bmi_exa_het)
View(bmi_exa_het)
bmi_exa_het <- mr_heterogeneity(bmi_exa_hm)
bmi_Fin_het <- mr_heterogeneity(bmi_Fin_hm)
bmi_UK_het <- mr_heterogeneity(bmi_UK_hm)
vit_exa_het <- mr_heterogeneity(vit_exa_hm)
vit_Fin_het <- mr_heterogeneity(vit_Fin_hm)
vit_UK_het <- mr_heterogeneity(vit_UK_hm)
View(bmi_Fin_het)
View(bmi_exa_hm)
View(bmi_exa_mr)
View(bmi_Fin_mr)
View(bmi_UK_mr)
# reform data into tables
table_name <- c(bmi_exa_mr)
for (table in table_name){
reformed_table <- data.frame(
# IVW method  3
b_IVW_MRE = table[3,7],
se_IVW_MRE = table[3,8],
pval_IVW_MRE = table[3,9],
# Egger method  1
b_Egger = table[1,7],
se_Egger = table[1,8],
pval_Egger = table[1,9],
# Weighted median  2
b_W_Med = table[2,7],
se_W_Med = table[2,8],
pval_W_Med = table[2,9],
# Weighted mode  5
b_W_Mod = table[5,7],
se_W_Mod = table[5,8],
pval_W_Mod = table[5,9],
# then
nsnps	= table[1,10]
# Heterogenous missing
# intercept missing
)
names(reformed_table) = paste0("reformed",name)
}
bmi_exa_mr[3,7]
View(bmi_exa_mr)
View(bmi_exa_mr)
# reform data into tables
table_name <- c("bmi_exa_mr")
reformed_table <- data.frame(
# IVW method  3
b_IVW_MRE = table[3,7],
se_IVW_MRE = table[3,8],
pval_IVW_MRE = table[3,9],
# Egger method  1
b_Egger = table[1,7],
se_Egger = table[1,8],
pval_Egger = table[1,9],
# Weighted median  2
b_W_Med = table[2,7],
se_W_Med = table[2,8],
pval_W_Med = table[2,9],
# Weighted mode  5
b_W_Mod = table[5,7],
se_W_Mod = table[5,8],
pval_W_Mod = table[5,9],
# then
nsnps	= table[1,10]
# Heterogenous missing
# intercept missing
)
bmi_exa_mr$b[3]
reformed_table <- data.frame(
# IVW method  3
b_IVW_MRE = table$b[3],
se_IVW_MRE = table$se[3],
pval_IVW_MRE = table$pval[3],
# Egger method  1
b_Egger = table$b[1],
se_Egger = table$se[1],
pval_Egger = table$pval[1],
# Weighted median  2
b_W_Med = table$b[2],
se_W_Med = table$se[2],
pval_W_Med = table$pval[2],
# Weighted mode  5
b_W_Mod = table$b[5],
se_W_Mod = table$se[5],
pval_W_Mod = table$pval[5],
# then
nsnps	= table$nsnp[1]
# Heterogenous missing
# intercept missing
)
bmi_exa_mr$b[3]
reformed_table <- data.frame(
# IVW method  3
b_IVW_MRE = bmi_exa_mr$b[3],
se_IVW_MRE = bmi_exa_mr$se[3],
pval_IVW_MRE = bmi_exa_mr$pval[3],
# Egger method  1
b_Egger = bmi_exa_mr$b[1],
se_Egger = bmi_exa_mr$se[1],
pval_Egger = bmi_exa_mr$pval[1],
# Weighted median  2
b_W_Med = bmi_exa_mr$b[2],
se_W_Med = bmi_exa_mr$se[2],
pval_W_Med = bmi_exa_mr$pval[2],
# Weighted mode  5
b_W_Mod = bmi_exa_mr$b[5],
se_W_Mod = bmi_exa_mr$se[5],
pval_W_Mod = bmi_exa_mr$pval[5],
# then
nsnps	= bmi_exa_mr$nsnp[1]
)
View(reformed_table)
bmi_exa_reformed <- data.frame(
# IVW method  3
b_IVW_MRE = bmi_exa_mr$b[3],
se_IVW_MRE = bmi_exa_mr$se[3],
pval_IVW_MRE = bmi_exa_mr$pval[3],
# Egger method  1
b_Egger = bmi_exa_mr$b[1],
se_Egger = bmi_exa_mr$se[1],
pval_Egger = bmi_exa_mr$pval[1],
# Weighted median  2
b_W_Med = bmi_exa_mr$b[2],
se_W_Med = bmi_exa_mr$se[2],
pval_W_Med = bmi_exa_mr$pval[2],
# Weighted mode  5
b_W_Mod = bmi_exa_mr$b[5],
se_W_Mod = bmi_exa_mr$se[5],
pval_W_Mod = bmi_exa_mr$pval[5],
# then
nsnps	= bmi_exa_mr$nsnp[1]
)
remove(reformed_table)
View(bmi_exa_mr)
library(tidyverse)
library(data.table)
for (table in table_name){
reformed_table <- data.frame(
# IVW method  3
b_IVW_MRE = table$b[3],
se_IVW_MRE = table$se[3],
pval_IVW_MRE = table$pval[3],
# Egger method  1
b_Egger = table$b[1],
se_Egger = table$se[1],
pval_Egger = table$pval[1],
# Weighted median  2
b_W_Med = table$b[2],
se_W_Med = table$se[2],
pval_W_Med = table$pval[2],
# Weighted mode  5
b_W_Mod = table$b[5],
se_W_Mod = table$se[5],
pval_W_Mod = table$pval[5],
# then
nsnps	= table$nsnp[1]
# Heterogenous missing
# intercept missing
)
#loop is not working, need to ask
gettext("reformed" + table) <- reformed_table
}
View(bmi_exa_hm)
View(bmi_exa_mr)
# reform data into tables
# table_name <- c("bmi_exa_mr","bmi_Fin_mr","bmi_UK_mr","vit_exa_mr","vit_Fin_mr","vit_UK_mr")
table_name <- c(bmi_exa_mr,bmi_Fin_mr,bmi_UK_mr,vit_exa_mr,vit_Fin_mr,vit_UK_mr)
View(table_name)
bmi_exa_mr[3,7]
for (table in table_name){
reformed_table <- data.frame(
# IVW method  3
b_IVW_MRE = table[3,7],
se_IVW_MRE = table[3,8],
pval_IVW_MRE = table[3,9],
# Egger method  1
b_Egger = table[1,7],
se_Egger = table[1,8],
pval_Egger = table[1,9],
# Weighted median  2
b_W_Med = table[2,7],
se_W_Med = table[2,8],
pval_W_Med = table[2,9],
# Weighted mode  5
b_W_Mod = table[5,7],
se_W_Mod = table[5,8],
pval_W_Mod = table[5,9],
# then
nsnps	= table[1,6]
# Heterogenous missing
# intercept missing
)
#loop is not working, need to ask
gettext("reformed" + table) <- reformed_table
}
vit_table <- c(vit_exa_mr,vit_Fin_mr,vit_UK_mr)
remove(table_name)
View(bmi_exa_mr)
View(bmi_Fin_hm)
View(bmi_ins)
r <- get_r_from_bsen(bmi_exa_hm)
library(TwoSampleMR)
library(tidyverse)
library(data.table)
r <- get_r_from_bsen(bmi_exa_hm)
View(bmi_Fin_hm)
r <- get_r_from_bsen(bmi_exa_hm, se = se.outcome)
View(bmi_exa_hm)
r <- get_r_from_bsen(bmi_exa_hm, se = bmi_exa_hm$se.outcome)
r <- get_r_from_bsen(bmi_exa_hm, se = se.outcome)
r <- get_r_from_bsen(bmi_exa_hm, se <- se.outcome)
r <- get_r_from_bsen(bmi_exa_hm, se == se.outcome)
View(bmi_exa_mr)
View(bmi_exa_hm)
get_r_from_bsen(bmi_exa_hm)
get_r_from_bsen(bmi_ins)
get_r_from_bsen(bmi_exa_mr)
get_r_from_bsen(bmi_example_out)
View(bmi_example_out)
table_name <- c(bmi_exa_mr,bmi_Fin_mr,bmi_UK_mr,vit_exa_mr,vit_Fin_mr,vit_UK_mr)
library(data.table)
table_name[1]
View(table_name)
table_name <- array(bmi_exa_mr,bmi_Fin_mr,bmi_UK_mr,vit_exa_mr,vit_Fin_mr,vit_UK_mr)
table_name[1]
table_name <- array(c(bmi_exa_mr,bmi_Fin_mr,bmi_UK_mr,vit_exa_mr,vit_Fin_mr,vit_UK_mr))
View(table_name)
table_name[1]
table_name <- c("bmi_exa_mr","bmi_Fin_mr","bmi_UK_mr","vit_exa_mr","vit_Fin_mr","vit_UK_mr")
table_name[1]
table_name <- c("bmi_exa_mr","bmi_Fin_mr")
for (i in 1:length(table_name)){
table <- table_name[i]
reformed_table <- data.frame(
# IVW method  3
b_IVW_MRE = table[3,7],
se_IVW_MRE = table[3,8],
pval_IVW_MRE = table[3,9],
# Egger method  1
b_Egger = table[1,7],
se_Egger = table[1,8],
pval_Egger = table[1,9],
# Weighted median  2
b_W_Med = table[2,7],
se_W_Med = table[2,8],
pval_W_Med = table[2,9],
# Weighted mode  5
b_W_Mod = table[5,7],
se_W_Mod = table[5,8],
pval_W_Mod = table[5,9],
# then
nsnps	= table[1,6]
# Heterogenous missing
# intercept missing
)
#loop is not working, need to ask
gettext("reformed" + table) <- reformed_table
}
for (i in 1:length(table_name)){
table <- cat(table_name[i])
reformed_table <- data.frame(
# IVW method  3
b_IVW_MRE = table[3,7],
se_IVW_MRE = table[3,8],
pval_IVW_MRE = table[3,9],
# Egger method  1
b_Egger = table[1,7],
se_Egger = table[1,8],
pval_Egger = table[1,9],
# Weighted median  2
b_W_Med = table[2,7],
se_W_Med = table[2,8],
pval_W_Med = table[2,9],
# Weighted mode  5
b_W_Mod = table[5,7],
se_W_Mod = table[5,8],
pval_W_Mod = table[5,9],
# then
nsnps	= table[1,6]
# Heterogenous missing
# intercept missing
)
#loop is not working, need to ask
gettext("reformed" + table) <- reformed_table
}
cat(table_name[1])
for (i in 1:length(table_name)){
table <- cat(table_name[i])
reformed_table <- data.frame(
# IVW method  3
b_IVW_MRE = table[3,7],
se_IVW_MRE = table[3,8],
pval_IVW_MRE = table[3,9],
# Egger method  1
b_Egger = table[1,7],
se_Egger = table[1,8],
pval_Egger = table[1,9],
# Weighted median  2
b_W_Med = table[2,7],
se_W_Med = table[2,8],
pval_W_Med = table[2,9],
# Weighted mode  5
b_W_Mod = table[5,7],
se_W_Mod = table[5,8],
pval_W_Mod = table[5,9],
# then
nsnps	= table[1,6]
# Heterogenous missing
# intercept missing
)
#loop is not working, need to ask
}
View(reformed_table)
table = cat(table_name[1])
table = cat(table_name[1])
table <- reture(cat(table_name[1]))
table <- return(cat(table_name[1]))
table <- sprintf(table_name[1])
table <- cat(table_name[1])
table <- sprintf(table_name[1])
table_name <- array(c(bmi_exa_mr,bmi_Fin_mr,bmi_UK_mr,vit_exa_mr,vit_Fin_mr,vit_UK_mr))
table <- sprintf(table_name[1])
table <- cat(table_name[1])
table_name <- c("bmi_exa_mr","bmi_Fin_mr","bmi_UK_mr","vit_exa_mr","vit_Fin_mr","vit_UK_mr")
table <- noquote(table_name[1])
table
table <- noquote(table_name[i])
for (i in 1:length(table_name)){
table <- noquote(table_name[i])
reformed_table <- data.frame(
# IVW method  3
b_IVW_MRE = table[3,7],
se_IVW_MRE = table[3,8],
pval_IVW_MRE = table[3,9],
# Egger method  1
b_Egger = table[1,7],
se_Egger = table[1,8],
pval_Egger = table[1,9],
# Weighted median  2
b_W_Med = table[2,7],
se_W_Med = table[2,8],
pval_W_Med = table[2,9],
# Weighted mode  5
b_W_Mod = table[5,7],
se_W_Mod = table[5,8],
pval_W_Mod = table[5,9],
# then
nsnps	= table[1,6]
# Heterogenous missing
# intercept missing
)
#loop is not working, need to ask
}
table
table = read.table(file = "bmi_exa_mr")
table = read.table("bmi_exa_mr")
table = read.table(bmi_exa_mr)
table = read.table(file = bmi_exa_mr)
gettext(table)
gettext(vit_exa_hm + ".csv")
gettext(cat(vit_exa_hm) + ".csv")
gettext(cat(bmi_exa_mr) + ".csv")
gettext(sprintf(bmi_exa_mr) + ".csv")
gettext(gettext(bmi_exa_mr) + ".csv")
gettext(names(bmi_exa_mr) + ".csv")
names(bmi_exa_mr)
header(bmi_exa_mr)
deparse(substitute(bmi_exa_mr))
gettext(deparse(substitute(bmi_exa_mr)) + ".csv")
gettext(deparse(substitute(bmi_exa_mr)))
gettext(bmi_exa_mr)
exists(bmi_exa_mr)
